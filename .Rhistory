library("sf") # load sf package used for spatial data
#library ("mapview") # package to create maps
#library ("raster") # package to work with rasters
library("rlist") #to work with lists
library("terra")
theme_set(theme_minimal(base_size = 14)) # set ggplot theme
setwd(here::here())
plots <- file.path(here::here("plots")) # species where to save plots
data.output <- file.path(here::here("output")) # specifies where to save outputs
data.input <- file.path(here::here("data-raw","r-raw"))
study_area_size_data <- read.csv2(paste0(data.input,"/coords_study_area_14102022.csv"), header=TRUE, sep=";", dec = ".")
summary(study_area_size_data)
str(study_area_size_data)
#extr cting the study area size and taking out the nas
study_area_size_data_no_nas <- study_area_size_data %>%
na.omit() %>%
dplyr:: select(longitude, latitude) %>%
tibble::rowid_to_column("id")
# calculating the radius of the buffer based on the study area size
buffer_size <- study_area_size_data %>%
na.omit() %>%
mutate(radius=(sqrt(study_area_size/pi) * 1000)) %>% # *1000 to convert to km
dplyr::select(radius)
#transforming the coordinates as spatial object
coords <- st_as_sf(study_area_size_data_no_nas, coords=c("longitude","latitude"), crs=4326)
#function to transform the latitude longitute projection of each poitns into the right UTM
lonlat2UTM = function(lonlat) {
utm = (floor((lonlat[1] + 180) / 6) %% 60) + 1
if(lonlat[2] > 0) {
utm + 32600
} else{
utm + 32700
}
}
#to transform in the right projection
transform_list <- function(list, crs_dataframe){
x <- list(0)
for (i in 1: length(crs_dataframe))
x[[i]] <- st_transform(list[[i]], crs_dataframe[i])
return(x)
}
# to create buffers based on a list of spatial objects
buffer_list <- function(list, buffer_size_dataframe){
y <- list(0)
for (i in 1: nrow(buffer_size_dataframe))
y[[i]] <- st_buffer(list[[i]], buffer_size_dataframe[i,])
return(y)
}
#take out the coordinates of the points
coordinates2<- cbind(study_area_size_data_no_nas$longitude, study_area_size_data_no_nas$latitude)
#transforms the coordinates into UTM
coordinatesUTM <- apply(coordinates2, 1, lonlat2UTM)
#creates a list of spatial objects based on their id
ncSplit <- split(coords, f = coords[["id"]])
#using the function to st_transform each element of the list with their corresponding UTM
list_UTM_points <- transform_list(ncSplit, coordinatesUTM)
# Create a list of buffers with their respective radius
buf_proj <- buffer_list(list_UTM_points, buffer_size)
# Retransform the whole shablam into a latitude longitude coordinate system
buf_latlong <- lapply(buf_proj, st_transform, 4326)
#recombining the hwole thing
combined <- list.rbind(buf_latlong)
combined %>%
ggplot() +
geom_sf(lwd = 0.1)
mapview(combined)
map_raster <- terra::rast(paste0(here::here("data-raw","geo-raw"),"/biomes_wgs.tif"))
str(map_raster)
#plot(map_raster)
plot(map_raster)
buffer_new_projection <- combined %>%
st_transform(crs = crs(map_raster))
extracted_values_mean_biomes <- raster::extract(map_raster, buffer_new_projection,fun=mean, na.rm=TRUE)
extracted_values_mean_biomes
saveRDS(extracted_values_mean_biomes,paste0(data.output,"/data-proc/extracted_values_mean_biomes",Sys.Date(),".rds"))
combined_buffer_biomes <- cbind(buffer_new_projection,extracted_values_mean_biomes)
#mapview(combined_buffer_biomes, zcol="extracted_values_mean_biomes")
dataframe_combined_buffer_biomes <- study_area_size_data %>%
na.omit() %>%
cbind(combined_buffer_biomes)
saveRDS(dataframe_combined_buffer_hfp,paste0(data.output,"/data-proc/dataframe_combined_buffer_biomes",Sys.Date(),".rds"))
combined_buffer_biomes <- cbind(buffer_new_projection,extracted_values_mean_biomes)
#mapview(combined_buffer_biomes, zcol="extracted_values_mean_biomes")
dataframe_combined_buffer_biomes <- study_area_size_data %>%
na.omit() %>%
cbind(combined_buffer_biomes)
saveRDS(dataframe_combined_buffer_biomes,paste0(data.output,"/data-proc/dataframe_combined_buffer_biomes",Sys.Date(),".rds"))
combined_buffer_biomes
library ("mapview") # package to create maps
mapview(combined)
map_raster <- terra::rast(paste0(here::here("data-raw","geo-raw"),"/biomes_wgs.tif"))
str(map_raster)
plot(map_raster)
mapview(combined_buffer_biomes, zcol="extracted_values_mean_biomes")
combined_buffer_biomes <- cbind(buffer_new_projection,extracted_values_mean_biomes)
mapview(combined_buffer_biomes, zcol="extracted_values_mean_biomes")
combined_buffer_biomes
buffer_new_projection
extracted_values_mean_biomes
extracted_values_mean_biomes
buffer_new_projection
extracted_values_mean_biomes
combined_buffer_biomes
extracted_values_mean_biomes
buffer_new_projection
extracted_values_mean_biomes
combined_buffer_biomes
combined_buffer_biomes <- cbind(buffer_new_projection,extracted_values_mean_biomes)
mapview(combined_buffer_biomes, zcol="extracted_values_mean_biomes")
mapview(combined_buffer_biomes, zcol="biomes_wgs")
dataframe_combined_buffer_biomes <- study_area_size_data %>%
na.omit() %>%
cbind(combined_buffer_biomes)
saveRDS(dataframe_combined_buffer_biomes,paste0(data.output,"/data-proc/dataframe_combined_buffer_biomes",Sys.Date(),".rds"))
mapview(combined_buffer_biomes, zcol="biomes_wgs")
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library("tidyverse") # loads packages tidyr, ggplot2 and dplyr
library("sf") # load sf package used for spatial data
#library ("mapview") # package to create maps
library ("raster") # package to work with rasters
library("rlist") #to work with lists
library("terra")
theme_set(theme_minimal(base_size = 14)) # set ggplot theme
setwd(here::here())
plots <- file.path(here::here("plots")) # species where to save plots
data.output <- file.path(here::here("output")) # specifies where to save outputs
data.input <- file.path(here::here("data-raw","r-raw"))
study_area_size_data <- read.csv2(paste0(data.input,"/coords_study_area_14102022.csv"), header=TRUE, sep=";", dec = ".")
summary(study_area_size_data)
str(study_area_size_data)
#extr cting the study area size and taking out the nas
study_area_size_data_no_nas <- study_area_size_data %>%
na.omit() %>%
dplyr:: select(longitude, latitude) %>%
tibble::rowid_to_column("id")
# calculating the radius of the buffer based on the study area size
buffer_size <- study_area_size_data %>%
na.omit() %>%
mutate(radius=(sqrt(study_area_size/pi) * 1000)) %>% # *1000 to convert to km
dplyr::select(radius)
#transforming the coordinates as spatial object
coords <- st_as_sf(study_area_size_data_no_nas, coords=c("longitude","latitude"), crs=4326)
View(buffer_size)
View(coords)
View(study_area_size_data)
View(study_area_size_data_no_nas)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library("tidyverse") # loads packages tidyr, ggplot2 and dplyr
library("sf") # load sf package used for spatial data
#library ("mapview") # package to create maps
library ("raster") # package to work with rasters
library("rlist") #to work with lists
library("terra")
theme_set(theme_minimal(base_size = 14)) # set ggplot theme
setwd(here::here())
plots <- file.path(here::here("plots")) # species where to save plots
data.output <- file.path(here::here("output")) # specifies where to save outputs
data.input <- file.path(here::here("data-raw","r-raw"))
study_area_size_data <- read.csv2(paste0(data.input,"/coords_study_area_14102022.csv"), header=TRUE, sep=";", dec = ".")
summary(study_area_size_data)
str(study_area_size_data)
#extr cting the study area size and taking out the nas
study_area_size_data_no_nas <- study_area_size_data %>%
na.omit() %>%
dplyr:: select(longitude, latitude) %>%
tibble::rowid_to_column("id")
# calculating the radius of the buffer based on the study area size
buffer_size <- study_area_size_data %>%
na.omit() %>%
mutate(radius=(sqrt(study_area_size/pi) * 1000)) %>% # *1000 to convert to km
dplyr::select(radius)
#transforming the coordinates as spatial object
coords <- st_as_sf(study_area_size_data_no_nas, coords=c("longitude","latitude"), crs=4326)
#function to transform the latitude longitute projection of each poitns into the right UTM
lonlat2UTM = function(lonlat) {
utm = (floor((lonlat[1] + 180) / 6) %% 60) + 1
if(lonlat[2] > 0) {
utm + 32600
} else{
utm + 32700
}
}
#to transform in the right projection
transform_list <- function(list, crs_dataframe){
x <- list(0)
for (i in 1: length(crs_dataframe))
x[[i]] <- st_transform(list[[i]], crs_dataframe[i])
return(x)
}
# to create buffers based on a list of spatial objects
buffer_list <- function(list, buffer_size_dataframe){
y <- list(0)
for (i in 1: nrow(buffer_size_dataframe))
y[[i]] <- st_buffer(list[[i]], buffer_size_dataframe[i,])
return(y)
}
#take out the coordinates of the points
coordinates2<- cbind(study_area_size_data_no_nas$longitude, study_area_size_data_no_nas$latitude)
#transforms the coordinates into UTM
coordinatesUTM <- apply(coordinates2, 1, lonlat2UTM)
#creates a list of spatial objects based on their id
ncSplit <- split(coords, f = coords[["id"]])
#using the function to st_transform each element of the list with their corresponding UTM
list_UTM_points <- transform_list(ncSplit, coordinatesUTM)
# Create a list of buffers with their respective radius
buf_proj <- buffer_list(list_UTM_points, buffer_size)
# Retransform the whole shablam into a latitude longitude coordinate system
buf_latlong <- lapply(buf_proj, st_transform, 4326)
#recombining the hwole thing
combined <- list.rbind(buf_latlong)
combined %>%
ggplot() +
geom_sf(lwd = 0.1)
mapview(combined)
map_raster <- terra::rast(paste0(here::here("data-raw","geo-raw"),"/HFP2009.tif"))
str(map_raster)
#plot(map_raster)
buffer_new_projection <- combined %>%
st_transform(crs = crs(map_raster))
extracted_values_mean_hfp <- raster::extract(map_raster, buffer_new_projection,fun=mean, na.rm=TRUE)
extracted_values_mean_hfp
saveRDS(extracted_values_mean_hfp,paste0(data.output,"/data-proc/extracted_values_mean_hfp",Sys.Date(),".rds"))
plot(map_raster)
combined_buffer_hfp <- cbind(buffer_new_projection,extracted_values_mean_hfp)
mapview(combined_buffer_hfp, zcol="extracted_values_mean_hfp")
buffer_new_projection <- combined %>%
st_transform(crs = crs(map_raster))
extracted_values_mean_hfp <- raster::extract(map_raster, buffer_new_projection,fun=mean, na.rm=TRUE)
extracted_values_mean_hfp
saveRDS(extracted_values_mean_hfp,paste0(data.output,"/data-proc/extracted_values_mean_hfp",Sys.Date(),".rds"))
extracted_values_mean_hfp
combined_buffer_hfp <- cbind(buffer_new_projection,extracted_values_mean_hfp)
mapview(combined_buffer_hfp, zcol="HFP2009")
combined_buffer_hfp
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library("tidyverse") # loads packages tidyr, ggplot2 and dplyr
library("sf") # load sf package used for spatial data
library ("mapview") # package to create maps
library ("raster") # package to work with rasters
library("rlist") #to work with lists
library("terra")
theme_set(theme_minimal(base_size = 14)) # set ggplot theme
setwd(here::here())
plots <- file.path(here::here("plots")) # species where to save plots
data.output <- file.path(here::here("output")) # specifies where to save outputs
data.input <- file.path(here::here("data-raw","r-raw"))
study_area_size_data <- read.csv2(paste0(data.input,"/coords_study_area_14102022.csv"), header=TRUE, sep=";", dec = ".")
summary(study_area_size_data)
str(study_area_size_data)
#extr cting the study area size and taking out the nas
study_area_size_data_no_nas <- study_area_size_data %>%
na.omit() %>%
dplyr:: select(longitude, latitude) %>%
tibble::rowid_to_column("id")
# calculating the radius of the buffer based on the study area size
buffer_size <- study_area_size_data %>%
na.omit() %>%
mutate(radius=(sqrt(study_area_size/pi) * 1000)) %>% # *1000 to convert to km
dplyr::select(radius)
#transforming the coordinates as spatial object
coords <- st_as_sf(study_area_size_data_no_nas, coords=c("longitude","latitude"), crs=4326)
#function to transform the latitude longitute projection of each poitns into the right UTM
lonlat2UTM = function(lonlat) {
utm = (floor((lonlat[1] + 180) / 6) %% 60) + 1
if(lonlat[2] > 0) {
utm + 32600
} else{
utm + 32700
}
}
#to transform in the right projection
transform_list <- function(list, crs_dataframe){
x <- list(0)
for (i in 1: length(crs_dataframe))
x[[i]] <- st_transform(list[[i]], crs_dataframe[i])
return(x)
}
# to create buffers based on a list of spatial objects
buffer_list <- function(list, buffer_size_dataframe){
y <- list(0)
for (i in 1: nrow(buffer_size_dataframe))
y[[i]] <- st_buffer(list[[i]], buffer_size_dataframe[i,])
return(y)
}
#take out the coordinates of the points
coordinates2<- cbind(study_area_size_data_no_nas$longitude, study_area_size_data_no_nas$latitude)
#transforms the coordinates into UTM
coordinatesUTM <- apply(coordinates2, 1, lonlat2UTM)
#creates a list of spatial objects based on their id
ncSplit <- split(coords, f = coords[["id"]])
#using the function to st_transform each element of the list with their corresponding UTM
list_UTM_points <- transform_list(ncSplit, coordinatesUTM)
# Create a list of buffers with their respective radius
buf_proj <- buffer_list(list_UTM_points, buffer_size)
# Retransform the whole shablam into a latitude longitude coordinate system
buf_latlong <- lapply(buf_proj, st_transform, 4326)
#recombining the hwole thing
combined <- list.rbind(buf_latlong)
combined %>%
ggplot() +
geom_sf(lwd = 0.1)
mapview(combined)
map_raster <- terra::rast(paste0(here::here("data-raw","geo-raw"),"/forloss_drivers_prj.tif"))
str(map_raster)
plot(map_raster)
buffer_new_projection <- combined %>%
st_transform(crs = crs(map_raster))
extracted_values_mean_forloss <- raster::extract(map_raster, buffer_new_projection,fun=mean, na.rm=TRUE)
extracted_values_mean_forloss
saveRDS(extracted_values_mean_hfp,paste0(data.output,"/data-proc/extracted_values_mean_forloss",Sys.Date(),".rds"))
saveRDS(extracted_values_mean_forloss,paste0(data.output,"/data-proc/extracted_values_mean_forloss",Sys.Date(),".rds"))
combined_buffer_forloss <- cbind(buffer_new_projection,extracted_values_mean_forloss)
mapview(combined_buffer_forloss, zcol="HFP2009")
extracted_values_mean_forloss
mapview(combined_buffer_forloss, zcol="forloss_drivers_prj")
dataframe_combined_buffer_forloss <- study_area_size_data %>%
na.omit() %>%
cbind(combined_buffer_forloss)
saveRDS(dataframe_combined_buffer_forloss,paste0(data.output,"/data-proc/dataframe_combined_buffer_forloss",Sys.Date(),".rds"))
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library("tidyverse") # loads packages tidyr, ggplot2 and dplyr
library("sf") # load sf package used for spatial data
library ("mapview") # package to create maps
library ("raster") # package to work with rasters
library("rlist") #to work with lists
library("terra")
theme_set(theme_minimal(base_size = 14)) # set ggplot theme
setwd(here::here())
plots <- file.path(here::here("plots")) # species where to save plots
data.output <- file.path(here::here("output")) # specifies where to save outputs
data.input <- file.path(here::here("data-raw","r-raw"))
study_area_size_data <- read.csv2(paste0(data.input,"/coords_study_area_14102022.csv"), header=TRUE, sep=";", dec = ".")
summary(study_area_size_data)
str(study_area_size_data)
#extr cting the study area size and taking out the nas
study_area_size_data_no_nas <- study_area_size_data %>%
na.omit() %>%
dplyr:: select(longitude, latitude) %>%
tibble::rowid_to_column("id")
# calculating the radius of the buffer based on the study area size
buffer_size <- study_area_size_data %>%
na.omit() %>%
mutate(radius=(sqrt(study_area_size/pi) * 1000)) %>% # *1000 to convert to km
dplyr::select(radius)
#transforming the coordinates as spatial object
coords <- st_as_sf(study_area_size_data_no_nas, coords=c("longitude","latitude"), crs=4326)
#function to transform the latitude longitute projection of each poitns into the right UTM
lonlat2UTM = function(lonlat) {
utm = (floor((lonlat[1] + 180) / 6) %% 60) + 1
if(lonlat[2] > 0) {
utm + 32600
} else{
utm + 32700
}
}
#to transform in the right projection
transform_list <- function(list, crs_dataframe){
x <- list(0)
for (i in 1: length(crs_dataframe))
x[[i]] <- st_transform(list[[i]], crs_dataframe[i])
return(x)
}
# to create buffers based on a list of spatial objects
buffer_list <- function(list, buffer_size_dataframe){
y <- list(0)
for (i in 1: nrow(buffer_size_dataframe))
y[[i]] <- st_buffer(list[[i]], buffer_size_dataframe[i,])
return(y)
}
#take out the coordinates of the points
coordinates2<- cbind(study_area_size_data_no_nas$longitude, study_area_size_data_no_nas$latitude)
#transforms the coordinates into UTM
coordinatesUTM <- apply(coordinates2, 1, lonlat2UTM)
#creates a list of spatial objects based on their id
ncSplit <- split(coords, f = coords[["id"]])
#using the function to st_transform each element of the list with their corresponding UTM
list_UTM_points <- transform_list(ncSplit, coordinatesUTM)
# Create a list of buffers with their respective radius
buf_proj <- buffer_list(list_UTM_points, buffer_size)
# Retransform the whole shablam into a latitude longitude coordinate system
buf_latlong <- lapply(buf_proj, st_transform, 4326)
#recombining the hwole thing
combined <- list.rbind(buf_latlong)
combined %>%
ggplot() +
geom_sf(lwd = 0.1)
mapview(combined)
map_raster <- terra::rast(paste0(here::here("data-raw","geo-raw"),"countries_ne_wgs/.tif"))
map_raster <- terra::rast(paste0(here::here("data-raw","geo-raw"),"/countries_ne_wgs/.tif"))
map_raster <- terra::rast(paste0(here::here("data-raw","geo-raw"),"/countries_ne_wgs.tif"))
str(map_raster)
plot(map_raster)
buffer_new_projection <- combined %>%
st_transform(crs = crs(map_raster))
extracted_values_mean_countries <- raster::extract(map_raster, buffer_new_projection,fun=mean, na.rm=TRUE)
extracted_values_mean_countries
saveRDS(extracted_values_mean_countries,paste0(data.output,"/data-proc/extracted_values_mean_countries",Sys.Date(),".rds"))
combined_buffer_hfp <- cbind(buffer_new_projection,extracted_values_mean_hfp)
combined_buffer_hfp <- cbind(buffer_new_projection,extracted_values_mean_hfp)
combined_buffer_hfp <- cbind(buffer_new_projection,extracted_values_mean_countries)
mapview(combined_buffer_countries, zcol="countries_ne_wgs")
combined_buffer_countries <- cbind(buffer_new_projection,extracted_values_mean_countries)
mapview(combined_buffer_countries, zcol="countries_ne_wgs")
dataframe_combined_buffer_countries <- study_area_size_data %>%
na.omit() %>%
cbind(combined_buffer_countries)
saveRDS(dataframe_combined_buffer_countries,paste0(data.output,"/data-proc/dataframe_combined_buffer_countries",Sys.Date(),".rds"))
```
```
```
```
```
library("devtools")
install.packages("devtools")
```
knitr::opts_chunk$set(echo = TRUE)
library("devtools")
install.packages("remotes")
install.packages("R.rsp")
remotes::install_github("jniedballa/camtrapR", build_vignettes = TRUE)
#install.packages("remotes")
#install.packages("R.rsp")
#remotes::install_github("jniedballa/camtrapR", build_vignettes = TRUE)
library("camtrapR")
Sys.getenv()
getwd()
setwd("C:/Users/carla/Documents/camtrapR")
getwd()
Sys.which("exiftool")
Sys.getenv("PATH")
Sys.which("exiftool")
## the first two are likely to exist everywhere
## texi2dvi exists on most Unix-alikes and under MiKTeX
Sys.which(c("ftp", "ping", "texi2dvi", "this-does-not-exist"))
Sys.which("exiftool")
Sys.which("exiftool")
knitr::opts_chunk$set(echo = TRUE)
library("devtools")
#install.packages("remotes")
#install.packages("R.rsp")
#remotes::install_github("jniedballa/camtrapR", build_vignettes = TRUE)
library("camtrapR")
library("raster")
library("mapview")
install.packages("ubms","magick","tesseract","coda","rjags","snowfall")
library ("ubms")
install.packages("ubms")
install.packages("magick")
install.packages("tesseract")
install.packages("coda")
install.packages("rjags")
install.packages("snowfall")
library("devtools")
#install.packages("remotes")
#install.packages("R.rsp")
#remotes::install_github("jniedballa/camtrapR", build_vignettes = TRUE)
library("camtrapR")
library("raster")
library("mapview")
#install.packages("ubms")
#install.packages("magick")
#install.packages("tesseract")
#install.packages("coda")
#install.packages("rjags")
#install.packages("snowfall")
library ("ubms") # package to fit Bayesian hierarchical models
library("magick") # package to work with image processing
library("tesseract") # package to find and summarise patterns
library("coda") # package to summarise and plot MCMC output
library ("rjags") # package for Bayesian Graphical Models
library ("rjags") # package for Bayesian Graphical Models
library ("rjags") # package for Bayesian Graphical Models
library("snowfall") # package for cluster computing
library ("rjags") # package for Bayesian Graphical Models
rm(rjags)
rm(library("rjags"))
getwd()
knitr::opts_chunk$set(echo = TRUE)
library("devtools")
#install.packages("remotes")
#install.packages("R.rsp")
#remotes::install_github("jniedballa/camtrapR", build_vignettes = TRUE)
library("camtrapR")
library("raster")
library("mapview")
#install.packages("ubms")
#install.packages("magick")
#install.packages("tesseract")
#install.packages("coda")
#install.packages("rjags")
#install.packages("snowfall")
library ("ubms") # package to fit Bayesian hierarchical models
library("magick") # package to work with image processing
library("tesseract") # package to find and summarise patterns
library("coda") # package to summarise and plot MCMC output
library ("rjags") # package for Bayesian Graphical Models
Sys.getenv("PATH")    # used to check which environments there are
# Choose one path and put exiftool there: "C:\\PROGRA~1\\RStudio\\bin\\quarto\\bin\\exiftool.exe"
Sys.which("exiftool") # Check if exiftool can be found
getwd() # used to find current wd
setwd(here::here())
getwd() # used to find current wd
plots <- file.path(here::here("plots")) # specifies where to save plots
data.output <- file.path(here::here("output")) # specifies where to save outputs
data.input <- file.path(here::here("data-raw","r-raw"))
rm(list=ls())
# adjust the working directory [wd]
getwd()  # alternative fct
